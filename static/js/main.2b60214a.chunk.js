(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{17:function(e,t,r){e.exports=r(34)},22:function(e,t,r){},28:function(e,t,r){},30:function(e,t,r){},32:function(e,t,r){},34:function(e,t,r){"use strict";r.r(t);var n=r(0),i=r.n(n),a=r(9),c=r.n(a),o=(r(22),r(1)),l=r(5),u=r(3),s=r(2),p=r(4),h=r(7),y=r(10),f=function(){function e(t){Object(o.a)(this,e),this.board=[],this.board=t}return Object(l.a)(e,[{key:"getTile",value:function(e,t){return t<0||t>=this.board.length?null:e<0||e>=this.board[0].length?null:this.board[t][e]}},{key:"getTilesBetween",value:function(e,t){var r=e.x,n=e.y,i=t.x-e.x,a=t.y-e.y;if(Math.abs(i)!==Math.abs(a)&&0!==i&&0!==a)return[];var c=[];for(i=i/Math.abs(i)||i,a=a/Math.abs(a)||a;r!==t.x||n!==t.y;)c.push(this.getTile(r,n)),r+=i,n+=a;return c}},{key:"getAllPiecesOfType",value:function(e){var t=[];return this.board.forEach(function(r){r.forEach(function(r){r.piece&&r.piece.type===e&&t.push(r)})}),t}},{key:"clearState",value:function(){this.board.forEach(function(e){e.forEach(function(e){e.actions=[],e.piece&&(e.piece.actions=[])})})}},{key:"toStore",value:function(){return this.board}}],[{key:"parseBoard",value:function(e){var t=this,r=[],n=e.split(";");return n.splice(n.length-1,1),n.forEach(function(e,n){var i=e.split(",");i=i.map(function(e,r){var i=e.trim(),a=null;return i&&(a={player:t.parsePlayer(i),type:t.parsePiece(i)}),{x:r,y:n,piece:a}}),r.push(i)}),r}},{key:"parsePlayer",value:function(e){if("string"!==typeof e&&2!==e.length)return null;switch(e.charAt(0)){case"B":return"black";case"W":return"white";default:return null}}},{key:"parsePiece",value:function(e){if("string"!==typeof e&&2!==e.length)return null;switch(e.charAt(1)){case"K":return"king";case"Q":return"queen";case"B":return"bishop";case"R":return"rook";case"N":return"knight";case"P":return"pawn";default:return null}}}]),e}(),b=function(){function e(){Object(o.a)(this,e)}return Object(l.a)(e,null,[{key:"atTurnStart",value:function(e){return e}},{key:"beforeMove",value:function(e){return e}},{key:"execute",value:function(e,t){return e}},{key:"afterMove",value:function(e){return e}}]),e}(),d=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,null,[{key:"atTurnStart",value:function(e){return e.board.getAllPiecesOfType(this.type).forEach(this.markAllowedMoves.bind(this,e)),e}},{key:"execute",value:function(e,t){if("MOVE_PIECE"!==t.type)return e;if(t.piece.type!==this.type)return e;var r=e.selectedTile,n=t.tile;return r.piece=null,n.piece=t.piece,e}},{key:"markAllowedMoves",value:function(e,t){var r=this,n=t.piece;this.allowedMoves.forEach(function(i){var a=t.x,c=t.y;a+=i.x,c+=i.y;for(var o=e.board.getTile(a,c);null!==o;){var l={type:"ATTACK_PIECE",piece:n,tile:o};if(o.actions.push(l),n.actions.push(l),o.piece&&o.piece.player===n.player)break;var u={type:"MOVE_PIECE",piece:n,tile:o};if(o.actions.push(u),n.actions.push(u),o.piece&&o.piece.player!==n.player)break;if(!r.repeat)break;a+=i.x,c+=i.y,o=e.board.getTile(a,c)}})}}]),t}(b);d.allowedMoves=[],d.type="",d.repeat=!0;var v=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(p.a)(t,e),t}(d);v.allowedMoves=[{x:1,y:1},{x:1,y:-1},{x:-1,y:1},{x:-1,y:-1}],v.type="bishop",v.repeat=!0;var O=v,k=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(p.a)(t,e),t}(d);k.allowedMoves=[{x:0,y:1},{x:0,y:-1},{x:1,y:0},{x:1,y:1},{x:1,y:-1},{x:-1,y:0},{x:-1,y:1},{x:-1,y:-1}],k.type="king",k.repeat=!1;var E=k,j=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(p.a)(t,e),t}(d);j.allowedMoves=[{x:1,y:2},{x:1,y:-2},{x:-1,y:2},{x:-1,y:-2},{x:2,y:1},{x:2,y:-1},{x:-2,y:1},{x:-2,y:-1}],j.type="knight",j.repeat=!1;var x=j,g=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,null,[{key:"markAllowedMoves",value:function(e,t){var r=t.piece,n="white"===r.player?-1:1,i=t.x,a=t.y,c=e.board.getTile(i,a+n);if(c&&!c.piece){var o={type:"MOVE_PIECE",piece:r,tile:c};c.actions.push(o),r.actions.push(o)}[{x:1,y:n},{x:-1,y:n}].forEach(function(t){var n=e.board.getTile(i+t.x,a+t.y);if(null!==n){var c={type:"ATTACK_PIECE",piece:r,tile:n};if(n.actions.push(c),r.actions.push(c),n.piece&&n.piece.player!==r.player){var o={type:"MOVE_PIECE",piece:r,tile:n};n.actions.push(o),r.actions.push(o)}}})}}]),t}(d);g.type="pawn",g.repeat=!1;var T=g,w=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,null,[{key:"atTurnStart",value:function(e){return e.board.getAllPiecesOfType("pawn").forEach(this.markAllowedMoves.bind(this,e)),e}},{key:"markAllowedMoves",value:function(e,t){var r=t.piece,n="white"===r.player?-1:1,i="white"===r.player?6:1,a=t.x,c=t.y;if(c===i){var o=e.board.getTile(a,c+n);if(!o.piece&&!(o=e.board.getTile(a,c+2*n)).piece){var l={type:"MOVE_PIECE",piece:r,tile:o};o.actions.push(l),r.actions.push(l)}}}}]),t}(b),P=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(p.a)(t,e),t}(d);P.allowedMoves=[{x:0,y:1},{x:0,y:-1},{x:1,y:0},{x:1,y:1},{x:1,y:-1},{x:-1,y:0},{x:-1,y:1},{x:-1,y:-1}],P.type="queen",P.repeat=!0;var C=P,A=function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(p.a)(t,e),t}(d);A.allowedMoves=[{x:0,y:1},{x:0,y:-1},{x:1,y:0},{x:-1,y:0}],A.type="rook",A.repeat=!0;var m=[O,x,E,T,w,C,A,function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,null,[{key:"beforeMove",value:function(e){return e.board.getAllPiecesOfType("king").forEach(this.markAllowedMoves.bind(this,e)),e}},{key:"execute",value:function(e,t){if("CASTLE"!==t.type)return e;if("king"!==t.piece.type)return e;var r=e.selectedTile,n=t.tile,i=t.rook,a=t.rookTile;return n.piece=t.piece,r.piece=null,a.piece=i.piece,i.piece=null,e}},{key:"markAllowedMoves",value:function(e,t){var r="white"===t.piece.player?7:0,n=e.board.getTile(7,r),i=e.board.getTile(0,r);this.hasMoved(e,t)||(this.setupCastle(e,t,n,1),this.setupCastle(e,t,i,-1))}},{key:"setupCastle",value:function(e,t,r,n){if(!r.piece||"rook"!==r.piece.type||r.piece.player!==t.piece.player)return!1;var i=!this.hasMoved(e,r),a=e.board.getTile(t.x+2*n,t.y),c=e.board.getTilesBetween(t,r);if(c.forEach(function(e){e.piece&&e.piece!==t.piece&&e.piece!==r.piece&&(i=!1)}),(c=e.board.getTilesBetween(t,a)).forEach(function(e){e.actions.filter(function(e){return"ATTACK_PIECE"===e.type&&e.piece.player!==t.piece.player}).length&&(i=!1)}),i){var o={type:"CASTLE",piece:t.piece,rook:r,rookTile:e.board.getTile(t.x+n,t.y),tile:a};a.actions.push(o),t.piece.actions.push(o)}}},{key:"hasMoved",value:function(e,t){var r=!1;return e.history.forEach(function(e){e.to.x===t.x&&e.to.y===t.y&&(r=!0)}),r}}]),t}(b)],B={winner:!1,rejected:!1,player:"white",selectedTile:null,board:f.parseBoard("\n    BR,BN,BB,BQ,BK,BB,BN,BR;\n    BP,BP,BP,BP,BP,BP,BP,BP;\n    ,,,,,,,;\n    ,,,,,,,;\n    ,,,,,,,;\n    ,,,,,,,;\n    WP,WP,WP,WP,WP,WP,WP,WP;\n    WR,WN,WB,WQ,WK,WB,WN,WR;\n    "),history:[]},M=Object(y.b)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;if(e.winner&&"RESET_GAME"!==t.type)return e;var r=e;switch(e=Object.assign({},e),console.log(e),console.log(t),t.type){case"SELECT_PIECE":return e=Object.assign(e,{selectedTile:t.tile});case"RESET_GAME":return B;default:return e.board=new f(e.board),m.forEach(function(r){return e=r.execute(e,t)}),m.forEach(function(t){return e=t.afterMove(e)}),e.rejected?r:(t.tile&&e.history.push({from:{x:e.selectedTile.x,y:e.selectedTile.y},to:{x:t.tile.x,y:t.tile.y}}),t.type.indexOf("@@redux")<0&&(e.player="white"===e.player?"black":"white"),e.board.clearState(),e.selectedTile=null,m.forEach(function(t){return e=t.atTurnStart(e)}),m.forEach(function(t){return e=t.beforeMove(e)}),e.board=e.board.toStore(),e)}}),W=(r(28),function(e){function t(e){return Object(o.a)(this,t),Object(u.a)(this,Object(s.a)(t).call(this,e))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"getPiece",value:function(){var e=this.props.tile.piece,t=e?e.player:"";return t&&e?"".concat(t," ").concat(e.type):""}},{key:"isLegal",value:function(){var e=this;if(!this.props.selectedTile||!this.props.selectedTile.piece)return!1;var t=this.props.selectedTile.piece,r=!1;return t.actions.filter(function(t){return t.tile===e.props.tile&&"ATTACK_PIECE"!==t.type}).forEach(function(t){t.tile.x===e.props.tile.x&&t.tile.y===e.props.tile.y&&(r=!0)}),r}},{key:"handleClick",value:function(){var e=this,t=this.props.selectedTile;if(t&&t.piece&&t.piece.player===this.props.player){var r=this.props.tile.actions.filter(function(e){return e.piece===t.piece&&"ATTACK_PIECE"!==e.type});if(console.log(this.props.tile.actions),console.log(r),r.forEach(function(t){e.props.dispatch(t)}),r.length)return}this.props.dispatch({type:"SELECT_PIECE",tile:this.props.tile})}},{key:"render",value:function(){var e=this.isLegal(),t=!1;return this.props.selectedTile&&(t=this.props.selectedTile.x===this.props.tile.x&&this.props.selectedTile.y===this.props.tile.y),i.a.createElement("div",{id:this.props.id,"data-x":this.props.tile.x,"data-y":this.props.tile.y,className:"tile ".concat(this.getPiece()," ").concat(t?"selected":""," ").concat(e?"legal":""),onClick:this.handleClick.bind(this)})}}],[{key:"parsePlayer",value:function(e){if("string"!==typeof e&&2!==e.length)return null;switch(e.charAt(0)){case"B":return"black";case"W":return"white";default:return null}}},{key:"parsePiece",value:function(e){if("string"!==typeof e&&2!==e.length)return null;switch(e.charAt(1)){case"K":return"king";case"Q":return"queen";case"B":return"bishop";case"R":return"rook";case"N":return"knight";case"P":return"pawn";default:return null}}}]),t}(n.Component));var S=Object(h.b)(function(e){return{player:e.player,selectedTile:e.selectedTile}})(W),I=(r(30),function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"drawBoard",value:function(){var e="A".charCodeAt(0);return this.props.board.map(function(t){var r=[],n=0,a=t.map(function(t){var r=String.fromCharCode(e)+n;return n+=1,i.a.createElement(S,{id:r,key:r,tile:t})});return r.push(i.a.createElement("div",{key:String.fromCharCode(e),className:"row"},a)),e+=1,r})}},{key:"render",value:function(){return console.log(this.props),i.a.createElement("div",{className:"board"},this.drawBoard.apply(this))}}],[{key:"parseRowCol",value:function(e){return{row:e.charCodeAt(0)-"A".charCodeAt(0),col:parseInt(e.charAt(1))}}}]),t}(n.Component));var _=Object(h.b)(function(e){return{selectedTile:e.selectedTile,board:e.board}})(I),N=(r(32),function(e){function t(){return Object(o.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement(h.a,{store:M},i.a.createElement("div",{className:"App"},i.a.createElement(_,null)))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(i.a.createElement(N,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[17,2,1]]]);
//# sourceMappingURL=main.2b60214a.chunk.js.map